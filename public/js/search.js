var Mconsole=function(){this.initPopovers(),this.search={form:$(".search-form"),results:$(".search-results"),icon:$(".search-form").find(".submit i"),ajax:null,data:[]},this.search.form.on("submit",function(){return!1}),$(document).on("click",function(){this.search.form.hasClass("open")&&this.search.data.length>0?this.search.results.show():this.search.results.hide()}.bind(this)),this.search.results.on("click",".search-result-item",function(){window.location.href=$(this).find("a").prop("href")}),this.search.form.on("keyup",this.handleSearch.bind(this))};Mconsole.prototype.initPopovers=function(){$(function(){$(".popovers").popover()})},Mconsole.prototype.handleSearch=function(){return this.search.ajax&&this.search.ajax.abort(),0==this.search.form.find("input").val().length?(this.search.results.children().remove(),this.search.results.hide(),void(this.search.data=[])):void(this.search.form.find("input").val().length<3||(this.search.icon.removeClass("icon-magnifier").addClass("fa fa-spin fa-spinner"),this.search.ajax=$.ajax({method:"GET",url:"/mconsole/api/search",data:this.search.form.serialize()}),this.search.ajax.success(this.handleSearchResults.bind(this))))},Mconsole.prototype.handleSearchResults=function(s){if(this.search.data=s,this.search.results.children().remove(),s.length>0){for(var a in s){var e=s[a],i=e.icon?'<i class="fa fa-'+e.icon+'"></i> ':"",t=$('<li class="search-result-item"><a href="'+e.link+'"><span class="details">'+i+e.title+"</span>"+e.description+'</a><div class="tags"></div></li>');if(e.tags&&e.tags.length>0)for(var a in e.tags){var r=$('<span class="tag">'+e.tags[a]+"</span>");r.appendTo(t.find(".tags"))}this.search.results.append(t)}this.search.form.hasClass("open")&&this.search.results.show()}else this.search.results.hide();this.search.icon.removeClass("fa fa-spin fa-spinner").addClass("icon-magnifier")},$(document).ready(function(){new Mconsole});