function VariablesHelper(e){this.helper=e,this.animating=!1,this.templates={withArgs:"@variable('{key}', [{arguments}])",withoutArgs:"@variable('{key}')"},this.init()}VariablesHelper.prototype.init=function(){this.helper.draggable({addClasses:!1,stop:function(e,t){$(t.helper).css({height:"auto"})}}),$(document).on("click",".toggle-variables-helper, .helper-close",this.toggle.bind(this)),$(document).on("click",".variable-back",this.back.bind(this)),$(document).on("click",".variable-use",this.use.bind(this));var e=this;new Clipboard(".variable-copy",{text:function(t){return e.makeDirective()}}),this.helper.find(".variable-item").on("click",this.select.bind(this))},VariablesHelper.prototype.select=function(e){this.helper.find(".list").hide();var t=$(e.target).data("key"),i=$(e.target).data("value"),r=i.match(/\$\w+/gi);r&&(r=this.removeDollarChar(r)),this.form(t,r)},VariablesHelper.prototype.toggle=function(e){this.helper.is(":visible")?this.helper.fadeOut(250):(this.helper.css("top",Math.max(0,($(window).height()-this.helper.outerHeight())/2+$(window).scrollTop())+"px"),this.helper.css("left",Math.max(0,($(window).width()-this.helper.outerWidth())/2+$(window).scrollLeft())+"px"),this.helper.fadeIn(250))},VariablesHelper.prototype.form=function(e,t){var i=this.helper.find(".variable-input"),r=this.helper.find(".input-list");if(t){t=t.reverse();for(var a in t){var l=$('<div class="form-group"><input class="form-control input-sm" name="'+t[a]+'" placeholder="'+t[a]+'"></div>');l.prependTo(r)}}e=$('<div class="form-group"><strong>'+e+"</strong></div>"),e.prependTo(r),i.show()},VariablesHelper.prototype.back=function(){this.helper.find(".input-list").html(""),this.helper.find(".variable-input").hide(),this.helper.find(".list").show()},VariablesHelper.prototype.use=function(){var e=this.makeDirective();this.helper.find(".input-list").append($('<div class="form-group"><textarea class="form-control" readonly>'+e+"</textarea></div>"))},VariablesHelper.prototype.makeDirective=function(){var e=this.helper.find(".form-group input"),t=e.length>0?this.templates.withArgs:this.templates.withoutArgs,i=this.helper.find(".input-list strong").text();if(t=t.replace("{key}",i),e.length>0){var r=[];e.each(function(e,t){r.push("'"+$(t).attr("name")+"' => '"+$(t).val()+"'")}),t=t.replace("{arguments}",r.join(", "))}return t},VariablesHelper.prototype.removeDollarChar=function(e){for(var t in e)e[t]=e[t].replace("$","");return e},$(function(){$(".variables-helper").length>0&&new VariablesHelper($(".variables-helper"))});